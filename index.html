<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Orçamento e Recibo</title>
<style>
  /* Reset básico */
  * { box-sizing: border-box; }

  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    background: #f4f7f8;
    color: #333;
  }

  header {
    text-align: center;
    padding: 1rem;
    background: #1e88e5;
    color: white;
  }

  main {
    max-width: 900px;
    margin: 20px auto;
    padding: 0 15px 30px;
  }

  section {
    background: white;
    border-radius: 10px;
    padding: 20px 30px;
    margin-bottom: 30px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }

  h2 {
    color: #1e88e5;
    border-bottom: 2px solid #1e88e5;
    padding-bottom: 5px;
    margin-bottom: 20px;
  }

  label {
    display: block;
    margin-top: 15px;
    font-weight: 600;
  }

  input[type="text"],
  input[type="number"],
  select,
  textarea {
    width: 100%;
    padding: 8px 10px;
    margin-top: 5px;
    border: 1.5px solid #ddd;
    border-radius: 5px;
    font-size: 1rem;
    resize: vertical;
  }

  textarea { min-height: 60px; }

  .flex-row {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
  }

  .flex-col-2 {
    flex: 1 1 48%;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
  }

  th, td {
    border: 1px solid #ddd;
    padding: 8px 10px;
    text-align: left;
  }

  th {
    background: #e3f2fd;
  }

  /* Abreviação de Quantidade no mobile */
  th .abbr { display: none; }
  th .full { display: inline; }

  .signatures {
    display: flex;
    justify-content: space-between;
    margin-top: 30px;
    gap: 20px;
    flex-wrap: wrap;
  }

  .signature-box {
    flex: 1;
    border-top: 1px solid #999;
    text-align: center;
    padding-top: 8px;
    font-size: 0.9rem;
    color: #555;
    min-width: 140px;
  }

  .buttons {
    margin-top: 20px;
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
  }

  button {
    background: #1e88e5;
    color: white;
    border: none;
    border-radius: 6px;
    padding: 12px 25px;
    font-size: 1rem;
    cursor: pointer;
    transition: background-color 0.3s;
    flex-grow: 1;
    min-width: 140px;
  }
  button:hover { background: #1669bb; }

  /* Ocultar botões no PDF */
  @media print {
    button, .no-print { display: none !important; }
  }

  /* Responsividade */
  @media (max-width: 600px) {
    .flex-row { flex-direction: column; }
    .flex-col-2 { flex: 1 1 100%; }
    .signatures { flex-direction: column; gap: 40px; }
    .signature-box { min-width: 100%; margin-bottom: 10px; }
    .buttons { flex-direction: column; gap: 15px; }
    button { min-width: 100%; flex-grow: 0; }
    /* Switch Quantidade → Qtd. */
    th .full { display: none; }
    th .abbr { display: inline; }
  }
</style>
</head>
<body>
<header>
  <h1>Sistema de Orçamento e Recibo</h1>
</header>

<main>
  <!-- ORÇAMENTO -->
  <section id="orcamento">
    <h2>Orçamento</h2>

    <div class="flex-row">
      <div class="flex-col-2">
        <label>Empresa</label>
        <input type="text" id="empresaNome" value="Empresa Exemplo LTDA" />
        <input type="text" id="empresaEndereco" value="Rua Exemplo, 123 - Cidade/UF" />
        <input type="text" id="empresaTelefone" value="(99) 99999-9999" />
      </div>
      <div class="flex-col-2">
        <label>Cliente</label>
        <input type="text" id="clienteNome" placeholder="Nome do cliente" />
        <input type="text" id="clienteEndereco" placeholder="Endereço do cliente" />
        <input type="text" id="clienteTelefone" placeholder="Telefone do cliente" />
      </div>
    </div>

    <div class="flex-row" style="margin-top: 10px;">
      <div class="flex-col-2">
        <label>Data</label>
        <input type="text" id="dataOrcamento" readonly />
      </div>
      <div class="flex-col-2">
        <label>Hora</label>
        <input type="text" id="horaOrcamento" readonly />
      </div>
    </div>

    <label>Descrição dos Serviços/Produtos</label>
    <textarea id="descricaoOrcamento" placeholder="Descreva aqui..."></textarea>

    <table id="itensTabela">
      <thead>
        <tr>
          <th>Descrição</th>
          <th><span class="full">Quantidade</span><span class="abbr">Qtd.</span></th>
          <th>Preço Unitário (R$)</th>
          <th>Preço Total (R$)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><input type="text" class="item-desc" placeholder="Item 1" /></td>
          <td><input type="number" class="item-quant" min="1" value="1" /></td>
          <td><input type="number" class="item-preco" min="0" step="0.01" value="0.00" /></td>
          <td class="item-total">0.00</td>
        </tr>
      </tbody>
    </table>

    <button id="addItemBtn" class="no-print" style="margin-top:10px;">Adicionar Item</button>

    <label>Observação</label>
    <textarea id="observacaoOrcamento" placeholder="Observações adicionais..."></textarea>

    <h3>Total: R$ <span id="totalOrcamento">0.00</span></h3>

    <div class="signatures">
      <div class="signature-box">Assinatura do Cliente</div>
      <div class="signature-box">Assinatura do Prestador</div>
    </div>

    <div class="buttons">
      <button id="baixarPdfOrcamento" class="no-print">Baixar PDF</button>
      <button id="compartilharOrcamento" class="no-print">Compartilhar</button>
    </div>
  </section>

  <!-- RECIBO -->
  <section id="recibo">
    <h2>Recibo</h2>

    <div class="flex-row">
      <div class="flex-col-2">
        <label>Empresa</label>
        <input type="text" id="empresaNomeRecibo" value="Empresa Exemplo LTDA" />
        <input type="text" id="empresaEnderecoRecibo" value="Rua Exemplo, 123 - Cidade/UF" />
        <input type="text" id="empresaTelefoneRecibo" value="(99) 99999-9999" />
      </div>
      <div class="flex-col-2">
        <label>Cliente</label>
        <input type="text" id="clienteNomeRecibo" placeholder="Nome do cliente" />
        <input type="text" id="clienteEnderecoRecibo" placeholder="Endereço do cliente" />
        <input type="text" id="clienteTelefoneRecibo" placeholder="Telefone do cliente" />
      </div>
    </div>

    <div class="flex-row" style="margin-top: 10px;">
      <div class="flex-col-2">
        <label>Data</label>
        <input type="text" id="dataRecibo" readonly />
      </div>
      <div class="flex-col-2">
        <label>Hora</label>
        <input type="text" id="horaRecibo" readonly />
      </div>
    </div>

    <label>Valor Total (R$)</label>
    <input type="number" id="valorTotalRecibo" min="0" step="0.01" />

    <label>Valor Entrada (R$)</label>
    <input type="number" id="valorEntradaRecibo" min="0" step="0.01" />

    <label>Valor Restante (R$)</label>
    <input type="number" id="valorRestanteRecibo" readonly />

    <label>Forma de Pagamento</label>
    <select id="formaPagamentoRecibo">
      <option>Dinheiro</option>
      <option>Cartão de Crédito</option>
      <option>Cartão de Débito</option>
      <option>Pix</option>
    </select>

    <div class="signatures">
      <div class="signature-box">Assinatura do Cliente</div>
      <div class="signature-box">Assinatura do Prestador</div>
    </div>

    <div class="buttons">
      <button id="baixarPdfRecibo" class="no-print">Baixar PDF</button>
      <button id="compartilharRecibo" class="no-print">Compartilhar</button>
    </div>
  </section>
</main>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
  // Atualiza data e hora
  function atualizarDataHora() {
    const agora = new Date();
    const data = agora.toLocaleDateString('pt-BR');
    const hora = agora.toLocaleTimeString('pt-BR', { hour12: false });
    document.getElementById('dataOrcamento').value = data;
    document.getElementById('horaOrcamento').value = hora;
    document.getElementById('dataRecibo').value = data;
    document.getElementById('horaRecibo').value = hora;
  }
  atualizarDataHora();
  setInterval(atualizarDataHora, 60000);

  // Totais do orçamento
  function atualizarTotalOrcamento() {
    let total = 0;
    document.querySelectorAll('#itensTabela tbody tr').forEach(row => {
      const q = +row.querySelector('.item-quant').value || 0;
      const p = +row.querySelector('.item-preco').value || 0;
      const t = q * p;
      row.querySelector('.item-total').textContent = t.toFixed(2);
      total += t;
    });
    document.getElementById('totalOrcamento').textContent = total.toFixed(2);
  }
  document.getElementById('addItemBtn').onclick = () => {
    const tbody = document.querySelector('#itensTabela tbody');
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td><input type="text" class="item-desc" placeholder="Item"/></td>
      <td><input type="number" class="item-quant" min="1" value="1"/></td>
      <td><input type="number" class="item-preco" min="0" step="0.01" value="0.00"/></td>
      <td class="item-total">0.00</td>
    `;
    tbody.appendChild(tr);
    tr.querySelectorAll('.item-quant, .item-preco').forEach(i => i.oninput = atualizarTotalOrcamento);
  };
  document.querySelectorAll('.item-quant, .item-preco').forEach(i => i.oninput = atualizarTotalOrcamento);
  atualizarTotalOrcamento();

  // Valor restante do recibo
  function atualizarValorRestante() {
    const t = +document.getElementById('valorTotalRecibo').value || 0;
    const e = +document.getElementById('valorEntradaRecibo').value || 0;
    document.getElementById('valorRestanteRecibo').value = (t - e).toFixed(2);
  }
  document.getElementById('valorTotalRecibo').oninput = atualizarValorRestante;
  document.getElementById('valorEntradaRecibo').oninput = atualizarValorRestante;
  atualizarValorRestante();

  // Gerar PDF de seção
  async function gerarPdfDaSecao(id, nomeArquivo) {
    const { jsPDF } = window.jspdf;
    const sec = document.getElementById(id);
    sec.querySelectorAll('button,.no-print').forEach(b => b.style.display = 'none');
    const canvas = await html2canvas(sec, { scale: 2 });
    sec.querySelectorAll('button,.no-print').forEach(b => b.style.display = '');
    const img = canvas.toDataURL('image/png');
    const pdf = new jsPDF('p','mm','a4');
    const w = pdf.internal.pageSize.getWidth();
    const h = (canvas.height * w) / canvas.width;
    pdf.addImage(img, 'PNG', 0, 10, w, h);
    pdf.save(nomeArquivo);
  }
  document.getElementById('baixarPdfOrcamento').onclick = () => gerarPdfDaSecao('orcamento','orcamento.pdf');
  document.getElementById('baixarPdfRecibo').onclick = () => gerarPdfDaSecao('recibo','recibo.pdf');

  // Compartilhar via email
  function shareEmail(subj, body) {
    window.location.href = `mailto:?subject=${encodeURIComponent(subj)}&body=${encodeURIComponent(body)}`;
  }
  function buildOrcText() {
    let s = '--- Orçamento ---\nEmpresa: '+document.getElementById('empresaNome').value+'\nCliente: '+document.getElementById('clienteNome').value+'\nTotal: R$'+document.getElementById('totalOrcamento').textContent;
    return s;
  }
  function buildRecText() {
    let s = '--- Recibo ---\nEmpresa: '+document.getElementById('empresaNomeRecibo').value+'\nCliente: '+document.getElementById('clienteNomeRecibo').value+'\nTotal: R$'+document.getElementById('valorTotalRecibo').value;
    return s;
  }
  document.getElementById('compartilharOrcamento').onclick = () => shareEmail('Orçamento', buildOrcText());
  document.getElementById('compartilharRecibo').onclick = () => shareEmail('Recibo', buildRecText());
</script>
</body>
</html>
